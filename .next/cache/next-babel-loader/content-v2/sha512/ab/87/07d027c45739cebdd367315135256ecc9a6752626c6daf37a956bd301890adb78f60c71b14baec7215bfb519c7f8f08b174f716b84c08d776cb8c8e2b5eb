{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _defineProperty from \"/Users/georgegilliland/Desktop/Projects/GraphGenerator/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"/Users/georgegilliland/Desktop/Projects/GraphGenerator/components/Visualisations/BarChart/index.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport * as d3 from \"d3\";\nimport './styles.css';\n\nvar BarChart = function BarChart(_ref) {\n  _s();\n\n  var data = _ref.data;\n\n  var _useState = useState({\n    \"height\": null,\n    \"width\": null,\n    \"canvas\": null,\n    \"scales\": null\n  }),\n      stateObj = _useState[0],\n      setState = _useState[1]; // Create canvas \n\n\n  var setCanvas = function setCanvas() {\n    var margin = {\n      top: 30,\n      right: 30,\n      bottom: 50,\n      left: 30\n    },\n        width = 400,\n        height = 350;\n    var svg = d3.select(\"#InnerBarchart\").append(\"svg\").attr(\"viewBox\", \"0 0 700 500\").attr('preserveAspectRatio', 'xMinYMin meet').attr('viewBox', '0 0 ' + (width + margin.left + margin.right) + ' ' + (height + margin.top + margin.bottom)).style(\"color\", \"#000000\").append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n    return svg;\n  }; // Create X axis & Y axis scales\n\n\n  var setScales = function setScales(data) {\n    var columnOne = Object.keys(data[0])[0];\n    var columnTwo = Object.keys(data[0])[1];\n    var xRange = [0, 400];\n    var yRange = [350, 0];\n    var xScale = d3.scaleBand().range(xRange).domain(data.map(function (d) {\n      return d[columnOne];\n    })).padding(0.1);\n    var yScale = d3.scaleLinear().domain([0, Math.max.apply(Math, data.map(function (o) {\n      return o[columnTwo];\n    })) + 10]).range(yRange);\n    return {\n      xScale: xScale,\n      yScale: yScale,\n      xRange: xRange,\n      yRange: yRange\n    };\n  }; // Append X and Y axis to canvas\n\n\n  var setAxesToCanvas = function setAxesToCanvas(canvas, scales) {\n    canvas.append(\"g\").attr(\"transform\", \"translate(0,\" + 350 + \")\").attr(\"class\", \"XAxis\").call(d3.axisBottom(scales.xScale).tickFormat(\"\"));\n    canvas.append(\"g\").attr(\"class\", \"YAxis\").call(d3.axisLeft(scales.yScale));\n  }; // Append bars to canvas\n\n\n  var setBarsToCanvas = function setBarsToCanvas(canvas, scales, data) {\n    var columnOne = Object.keys(data[0])[0];\n    var columnTwo = Object.keys(data[0])[1];\n    canvas.selectAll(\"mybar\").data(data).enter().append(\"rect\").attr(\"class\", \"BarchartBars\").attr(\"x\", function (d) {\n      return scales.xScale(d[columnOne]);\n    }).attr(\"y\", function (d) {\n      return scales.yScale(d[columnTwo]);\n    }).attr(\"width\", scales.xScale.bandwidth()).attr(\"height\", function (d) {\n      return 350 - scales.yScale(d[columnTwo]);\n    }).style(\"fill\", \"#576675\");\n    canvas.selectAll(\".BarLabel\").data(data).enter().append(\"text\").classed(\"BarLabel\", true).attr(\"text-anchor\", \"left\").text(function (d) {\n      return d[columnOne];\n    }).attr(\"transform\", function (d, i) {\n      return \"translate(\" + (scales.xScale(d[columnOne]) + scales.xScale.bandwidth() / 2 - 3) + \",\" + (350 + 20) + \")\";\n    }); // Update state for update funcations\n\n    var tmpStateObj = _objectSpread({}, stateObj);\n\n    tmpStateObj.canvas = canvas;\n    tmpStateObj.height = 350;\n    tmpStateObj.scales = {\n      xScale: scales.xScale,\n      yScale: scales.yScale,\n      xRange: scales.xRange,\n      yRange: scales.yRange\n    };\n    setState(tmpStateObj);\n  };\n\n  var handleDropdownChange = function handleDropdownChange(val) {\n    var columnOne = Object.keys(JSON.parse(data)[0])[0];\n    var columnTwo = Object.keys(JSON.parse(data)[0])[1];\n    var tmpData = JSON.parse(data);\n\n    if (val === \"ascending\") {\n      tmpData.sort(function (a, b) {\n        return Number(a[columnTwo]) - Number(b[columnTwo]);\n      });\n    } else if (val === \"descending\") {\n      tmpData.sort(function (a, b) {\n        return Number(b[columnTwo]) - Number(a[columnTwo]);\n      });\n    } else if (val === \"key\") {\n      tmpData.sort(function (a, b) {\n        return a[columnOne].localeCompare(b[columnOne]);\n      });\n    } else {\n      tmpData = JSON.parse(data);\n    }\n\n    stateObj.scales.xScale.domain(tmpData.map(function (d) {\n      return d[columnOne];\n    }));\n    stateObj.canvas.selectAll(\"rect\").transition().duration(500).attr(\"x\", function (d, i) {\n      return stateObj.scales.xScale(d[columnOne]);\n    });\n    stateObj.canvas.selectAll(\".bar-label\").transition().duration(500).attr(\"transform\", function (d, i) {\n      return \"translate(\" + (stateObj.scales.xScale(d[columnOne]) + stateObj.scales.xScale.bandwidth() / 2 - 3) + \",\" + (stateObj.height + 20) + \")\";\n    });\n  }; // Bar colour change\n\n\n  var handleDropdownColourChange = function handleDropdownColourChange(val) {\n    d3.selectAll(\"rect\").transition().duration(500).style(\"fill\", val);\n  }; // Once component has mounted, this prevents the graph from being repeatedly displayed\n\n\n  useEffect(function () {\n    if (data) {\n      var canvas = setCanvas();\n      var scales = setScales(JSON.parse(data));\n      setAxesToCanvas(canvas, scales);\n      setBarsToCanvas(canvas, scales, JSON.parse(data));\n    }\n  }, [data]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: style.Chart,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styleGraphTitle,\n      children: \"BarChart\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: style.InnerBarchart\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: style.ButtonContainer\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 13\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 163,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(BarChart, \"rRQWVbZ8qCO2tJA+h1LWAhkHYCw=\");\n\n_c = BarChart;\nexport default BarChart;\n\nvar _c;\n\n$RefreshReg$(_c, \"BarChart\");","map":{"version":3,"sources":["/Users/georgegilliland/Desktop/Projects/GraphGenerator/components/Visualisations/BarChart/index.js"],"names":["React","useState","useEffect","d3","BarChart","data","stateObj","setState","setCanvas","margin","top","right","bottom","left","width","height","svg","select","append","attr","style","setScales","columnOne","Object","keys","columnTwo","xRange","yRange","xScale","scaleBand","range","domain","map","d","padding","yScale","scaleLinear","Math","max","apply","o","setAxesToCanvas","canvas","scales","call","axisBottom","tickFormat","axisLeft","setBarsToCanvas","selectAll","enter","bandwidth","classed","text","i","tmpStateObj","handleDropdownChange","val","JSON","parse","tmpData","sort","a","b","Number","localeCompare","transition","duration","handleDropdownColourChange","Chart","styleGraphTitle","InnerBarchart","ButtonContainer"],"mappings":"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","sourcesContent":["import React, { useState, useEffect }  from 'react';\nimport * as d3 from \"d3\";\nimport './styles.css';\n\nconst BarChart = ({data}) => {\n\n    const [stateObj, setState] = useState({\n        \"height\": null,\n        \"width\": null,\n        \"canvas\": null,\n        \"scales\": null\n    });\n\n    // Create canvas \n    const setCanvas = () => {\n        const margin = {top: 30, right: 30, bottom: 50, left: 30},\n        width = 400,\n        height = 350;\n        \n        let svg = d3\n            .select(\"#InnerBarchart\")\n            .append(\"svg\")\n                .attr(\"viewBox\", \"0 0 700 500\")\n                .attr('preserveAspectRatio', 'xMinYMin meet')\n                .attr(\n                    'viewBox',\n                    '0 0 ' +\n                    (width + margin.left + margin.right) +\n                    ' ' +\n                    (height + margin.top + margin.bottom)\n                )\n                .style(\"color\", \"#000000\") \n                .append(\"g\")\n                .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        return svg;\n    }\n\n    // Create X axis & Y axis scales\n    const setScales = (data) => {\n        let columnOne = Object.keys(data[0])[0];\n        let columnTwo = Object.keys(data[0])[1];\n        let xRange = [ 0, 400 ];\n        let yRange = [ 350, 0]; \n\n        let xScale = d3.scaleBand()\n            .range(xRange)\n            .domain(data.map(function(d){\n                return d[columnOne];\n            }))\n            .padding(0.1);\n      \n        let yScale = d3.scaleLinear()\n            .domain([0, Math.max.apply(Math, data.map(function(o) { \n                return o[columnTwo]; \n            })) + 10])\n            .range(yRange)\n\n        return { xScale: xScale, yScale: yScale, xRange: xRange, yRange: yRange };\n    }\n\n    // Append X and Y axis to canvas\n    const setAxesToCanvas = (canvas, scales) => {\n        canvas.append(\"g\")\n            .attr(\"transform\", \"translate(0,\" + 350 + \")\")\n            .attr(\"class\", \"XAxis\")\n            .call(d3.axisBottom(scales.xScale).tickFormat(\"\"));       \n      \n        canvas.append(\"g\")\n            .attr(\"class\", \"YAxis\")\n            .call(d3.axisLeft(scales.yScale));\n    }\n    \n    // Append bars to canvas\n    const setBarsToCanvas = (canvas, scales, data) => {\n        let columnOne = Object.keys(data[0])[0];\n        let columnTwo = Object.keys(data[0])[1];\n\n        canvas.selectAll(\"mybar\")\n            .data(data)\n            .enter()\n            .append(\"rect\")\n                .attr(\"class\", \"BarchartBars\")\n                .attr(\"x\", function(d) { return scales.xScale(d[columnOne]); })\n                .attr(\"y\", function(d) { return scales.yScale(d[columnTwo]); })\n                .attr(\"width\", scales.xScale.bandwidth())\n                .attr(\"height\", function(d) { return 350 - scales.yScale(d[columnTwo]); })\n                .style(\"fill\", \"#576675\")\n\n        canvas.selectAll(\".BarLabel\")\n            .data(data)\n                .enter()\n            .append(\"text\")\n            .classed(\"BarLabel\", true)\n                .attr(\"text-anchor\",\"left\")\n                .text(function(d){return d[columnOne]})\n                .attr(\"transform\", function(d, i) {\n                    return \"translate(\" + (scales.xScale(d[columnOne]) + scales.xScale.bandwidth() / 2 - 3) + \",\" + (350 + 20) + \")\"\n                })       \n                \n        // Update state for update funcations\n        let tmpStateObj = {...stateObj};\n        tmpStateObj.canvas = canvas;\n        tmpStateObj.height = 350;\n        tmpStateObj.scales = { xScale: scales.xScale, yScale: scales.yScale, xRange: scales.xRange, yRange: scales.yRange }\n        setState(tmpStateObj)\n    }\n\n    const handleDropdownChange = (val) => {\n        let columnOne = Object.keys(JSON.parse(data)[0])[0];\n        let columnTwo = Object.keys(JSON.parse(data)[0])[1];\n        let tmpData = JSON.parse(data);\n\n        if (val === \"ascending\") {\n            tmpData.sort((a, b) => Number(a[columnTwo]) - Number(b[columnTwo]))\n        } else if (val === \"descending\") {\n            tmpData.sort((a, b) => Number(b[columnTwo]) - Number(a[columnTwo]))\n        } else if (val === \"key\") {\n            tmpData.sort((a, b) => a[columnOne].localeCompare(b[columnOne]))\n        } else {\n            tmpData = JSON.parse(data);\n        }\n\n        stateObj.scales.xScale.domain(tmpData.map(function(d) {\n            return d[columnOne];\n        }));\n\n        stateObj.canvas.selectAll(\"rect\")\n            .transition()\n            .duration(500)\n            .attr(\"x\", function(d, i) {\n                return stateObj.scales.xScale(d[columnOne]);\n            })  \n        \n        stateObj.canvas.selectAll(\".bar-label\")\n            .transition()\n            .duration(500)\n            .attr(\"transform\", function(d, i) {\n                return \"translate(\" + (stateObj.scales.xScale(d[columnOne]) + \n                    stateObj.scales.xScale.bandwidth() / 2 - 3) + \",\" + (stateObj.height + 20) + \")\"\n            })\n    }\n\n    // Bar colour change\n    const handleDropdownColourChange = (val) => {\n        d3.selectAll(\"rect\")\n            .transition()\n            .duration(500)\n            .style(\"fill\", val)\n    }\n\n    // Once component has mounted, this prevents the graph from being repeatedly displayed\n    useEffect(() => {\n        if (data) {\n            let canvas = setCanvas();\n            let scales = setScales(JSON.parse(data));\n            setAxesToCanvas(canvas, scales)\n            setBarsToCanvas(canvas, scales, JSON.parse(data))\n        }\n    }, [data]);\n\n    return (\n        <div className={style.Chart}>\n            <div className={styleGraphTitle}>\n                BarChart\n            </div>\n            <div id={style.InnerBarchart}></div>\n            <div className={style.ButtonContainer}>\n                \n            </div>\n        </div>\n    )\n};\n\nexport default BarChart;\n"]},"metadata":{},"sourceType":"module"}